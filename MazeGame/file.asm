

org 100h

CALL PRINTDOTS  

MOV DX,2000h   
MOV AL,0001000B  
mov cl,0001000B
MOV INIT[0],AL
OUT DX,AL   
mov si,0    


READ:     
CALL READKEY  


SAG:    
cmp ah,4dh 
JNE SOL   
CALL GORIGHT 
JMP READ

SOL:  
cmp ah,4Bh  
JNE ASAGI   
CALL GOLEFT 
JMP READ    

ASAGI:       
cmp ah,50H  
JNE YUKARI   
CALL GODOWN 
JMP READ    

YUKARI:
cmp ah,48h  
JNE EXIT   
CALL GOUP 
JMP READ 

EXIT:
MOV AH,4CH 
INT 21H  



ret

INIT DB 0000000B, 0000000B, 0000000B, 0000000B, 0000000B,1110111B, 1000001B, 1111001B, 1111011B, 1000001B, 1011111B, 1011111B, 1010001B, 1010101B, 1000101B, 1111101B, 1000101B, 1010001B, 1010101B, 1010101B, 1100011B, 1000001B, 1011101B, 1011101B, 1011101B, 1001001B, 1000101B, 1011101B, 1100001B, 1101111B, 1000001B, 1010101B, 1010101B, 1010101B, 1111101b, 0000000B, 0000000B, 0000000B, 0000000B, 0000000B


PRINTDOTS PROC  

	MOV DX,2000h	
	MOV BX, 0

MAINLOOP:
	MOV SI, 0
	MOV CX, 5

NEXT:
	MOV AL,Init[BX][SI]
	out dx,al
	INC SI
	INC DX

	CMP SI, 5
	LOOPNE NEXT

	ADD BX, 5
	CMP BX, 40
	JL MAINLOOP  
	
	RET  
    
PRINTDOTS ENDP     

READKEY PROC
MOV AH,00h
INT 16H   
RET    
READKEY ENDP      

GOLEFT PROC   
    
TEST INIT[SI-1],cl
JNZ READ    
    
CMP DX,2000H
JE READ   

SUB INIT[SI],cl 
MOV AL,INIT[SI] 
OUT DX,AL 
DEC DX      

ADD INIT[SI-1],cl  
MOV AL,INIT[SI-1]
OUT DX,AL  
DEC SI
RET

GOLEFT ENDP    

GORIGHT PROC    
 
TEST INIT[SI+1],cl
JNZ READ
 
CMP DX,2027H
JE READ 

SUB INIT[SI],cl  
MOV AL,INIT[SI] 
OUT DX,AL  
INC DX         

ADD INIT[SI+1],cl 
MOV AL,INIT[SI+1]
OUT DX,AL  
INC SI
RET    

GORIGHT ENDP        

GODOWN PROC  
   

cmp cl,0100000B 
je oneQ 
cmp cl,0010000B 
je twoQ
cmp cl,0001000B  
je threeQ
cmp cl,0000100B 
je fourQ 
cmp cl,0000010B 
je fiveQ
cmp cl,0000001B  
je sixQ  
jne READ 

oneQ:
TEST INIT[SI],1000000B 
JNZ READ   
ADD INIT[SI],1000000B 
sub INIT[SI],cl  
mov cl, 1000000B
MOV AL,INIT[SI]
OUT DX,AL  
jmp READ
twoQ:
TEST INIT[SI],0100000B 
JNZ READ   
ADD INIT[SI],0100000B 
sub INIT[SI],cl  
mov cl, 0100000B
MOV AL,INIT[SI]
OUT DX,AL  
jmp READ
threeQ:
TEST INIT[SI],0010000B 
JNZ READ   
ADD INIT[SI],0010000B 
sub INIT[SI],cl  
mov cl, 0010000B
MOV AL,INIT[SI]
OUT DX,AL  
jmp READ
fourQ: 
TEST INIT[SI],0001000B 
JNZ READ  
ADD INIT[SI],0001000B 
sub INIT[SI],cl  
mov cl, 0001000B
MOV AL,INIT[SI]
OUT DX,AL  
jmp READ
fiveQ:
TEST INIT[SI],0000100B 
JNZ READ
ADD INIT[SI],0000100B 
sub INIT[SI],cl
MOV AL,INIT[SI] 
mov cl, 0000100B
OUT DX,AL 
jmp READ 
sixQ:  
TEST INIT[SI],0000010B 
JNZ READ
ADD INIT[SI],0000010B 
sub INIT[SI],cl
MOV AL,INIT[SI] 
mov cl, 0000010B
OUT DX,AL 
jmp READ    
       
RET

GODOWN ENDP      

GOUP PROC

cmp cl,1000000B 
je one 
cmp cl,0100000B 
je two
cmp cl,0010000B  
je three
cmp cl,0001000B 
je four 
cmp cl,0000100B 
je five
cmp cl,0000010B  
je six  
jne READ 

one:   
TEST INIT[SI],0100000B 
JNZ READ
ADD INIT[SI],0100000B 
sub INIT[SI],cl  
mov cl, 0100000B
MOV AL,INIT[SI]
OUT DX,AL  
jmp READ
two:
TEST INIT[SI],0010000B 
JNZ READ   
ADD INIT[SI],0010000B 
sub INIT[SI],cl  
mov cl, 0010000B
MOV AL,INIT[SI]
OUT DX,AL  
jmp READ
three:
TEST INIT[SI],0001000B 
JNZ READ   
ADD INIT[SI],0001000B 
sub INIT[SI],cl  
mov cl, 0001000B
MOV AL,INIT[SI]
OUT DX,AL  
jmp READ
four: 
TEST INIT[SI],0000100B 
JNZ READ  
ADD INIT[SI],0000100B 
sub INIT[SI],cl  
mov cl, 0000100B
MOV AL,INIT[SI]
OUT DX,AL  
jmp READ
five: 
TEST INIT[SI],0000010B 
JNZ READ
ADD INIT[SI],0000010B 
sub INIT[SI],cl
MOV AL,INIT[SI] 
mov cl, 0000010B
OUT DX,AL 
jmp READ 
six: 
TEST INIT[SI],0000001B 
JNZ READ
ADD INIT[SI],0000001B 
sub INIT[SI],cl
MOV AL,INIT[SI] 
mov cl, 0000001B
OUT DX,AL 
jmp READ 


RET       

GOUP ENDP


